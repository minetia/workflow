<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PHOENIX V44.2 MASTER DASHBOARD</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700;900&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; background: #0c0d10; color: #d1d4dc; overflow: hidden; }
        .nav-item { font-size: 13px; font-weight: 500; cursor: pointer; transition: 0.2s; color: #9ca3af; text-decoration: none;}
        .nav-item:hover, .active-nav { color: #f97316; }
        .status-bar { background: #1e1b0c; border-bottom: 1px solid #363a45; }
        .sidebar { background: #131722; border-left: 1px solid #363a45; }
        .chart-container { background: #131722; height: calc(100vh - 100px); }
        /* ì»¤ìŠ¤í…€ ìŠ¤í¬ë¡¤ë°” */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #363a45; border-radius: 10px; }
    </style>
</head>
<body class="flex flex-col h-screen">

    <nav class="flex items-center justify-between px-4 py-2 bg-[#131722] border-b border-[#363a45]">
        <div class="flex items-center gap-6">
            <a href="index.html" class="text-orange-500 font-black text-xl italic tracking-tighter">PHOENIX <span class="bg-green-600 text-[10px] text-white px-1 ml-1 not-italic font-bold">V44.2 í´ë¦°</span></a>
            <div class="hidden md:flex gap-6">
                <a href="trade.html" class="nav-item">ê±°ë˜ì†Œ</a>
                <span class="nav-item opacity-50">íˆ¬ìë‚´ì—­</span>
                <span class="nav-item opacity-50">ì§„í™”ìƒì„¸</span>
                <a href="admin.html" class="nav-item text-orange-400 font-bold">ğŸ”“ ë§ˆìŠ¤í„° ê¸ˆê³ </a>
                <a href="court.html" class="nav-item text-rose-500 font-bold">âš–ï¸ í˜•ë²Œ ì‚¬ë²•ë¶€</a>
                <a href="https://t.me/soong0233_bot" target="_blank" class="nav-item text-blue-400 font-bold">ğŸ¤– ì†¡ë´‡ ì—°ë™</a>
            </div>
        </div>
        <div class="text-[12px] flex items-center gap-3">
            <span class="text-xs font-bold text-slate-400">ë§ˆì§€ë§‰ ì •ì°°: <span id="last-time" class="text-white">ëŒ€ê¸°ì¤‘</span></span>
            <span class="text-rose-500 font-black bg-rose-950/30 px-3 py-1 rounded-full border border-rose-900/50">â— í™˜ì‚° ì´ ìì‚°: <span id="total-asset">0</span> KRW</span>
        </div>
    </nav>

    <div class="status-bar px-4 py-1.5 flex justify-between items-center">
        <div class="text-[11px] text-green-500 font-bold">
            <span class="bg-green-900/50 px-2 py-0.5 rounded mr-2 border border-green-700">STRICT MODE</span> 
            AI ìì‚° <span class="text-white">1,000ë§Œ ì›</span> ë…ë¦½ ì„¸íŒ… ì™„ë£Œ. 100% ë¦¬ì–¼ ë§¤ë§¤ ê°€ë™
        </div>
    </div>

    <div class="flex flex-1 overflow-hidden">
        <main class="flex-1 chart-container relative">
            <div id="tradingview_widget" class="w-full h-full"></div>
        </main>

        <aside class="sidebar w-80 hidden lg:flex flex-col p-4 space-y-4">
            <div>
                <h3 id="current-coin-title" class="text-orange-400 text-xs font-bold mb-2">[KRW-BTC] ë”¥ëŸ¬ë‹ 70+ ë³´ì¡°ì§€í‘œ ë¶„ì„</h3>
                <div class="flex justify-between items-center bg-black/40 p-2 rounded border border-slate-800">
                    <span class="text-[11px] text-slate-400">ì‹œì¥ ìƒíƒœ (AI íŒë…)</span>
                    <span id="market-state" class="text-[11px] font-bold text-emerald-400 blink">ë°ì´í„° ìˆ˜ì§‘ì¤‘</span>
                </div>
            </div>

            <div class="flex-1 flex flex-col bg-slate-900/30 rounded-xl p-4 border border-slate-800 overflow-hidden">
                <h4 class="text-[11px] font-bold mb-3 flex justify-between items-center">
                    <span>ğŸ“Š ì‹¤ì‹œê°„ í™•ë¥  ë­í‚¹</span>
                    <span class="text-[9px] text-slate-500 font-normal">í´ë¦­í•˜ì—¬ ì°¨íŠ¸ ì „í™˜</span>
                </h4>
                <div id="prob-list" class="flex-1 overflow-y-auto space-y-1 pr-1">
                    <div class="text-center text-[10px] text-slate-600 mt-10">ì—”ì§„ ë™ê¸°í™” ëŒ€ê¸°ì¤‘...</div>
                </div>
            </div>
            
            <div class="h-32 bg-slate-900/30 rounded-xl p-4 border border-slate-800">
                <h4 class="text-[11px] font-bold mb-2">ğŸ“¥ ì‹¤ì‹œê°„ ì²´ê²°ë‚´ì—­</h4>
                <div class="h-full overflow-hidden opacity-50 text-[10px] text-slate-400 flex items-center justify-center border-t border-slate-800 border-dashed mt-2">
                    ì‹ ê·œ ì²´ê²° ëŒ€ê¸°ì¤‘...
                </div>
            </div>
        </aside>
    </div>

    <script>
        // í˜„ì¬ ë³´ê³  ìˆëŠ” ì°¨íŠ¸ ì‹¬ë³¼ (ì´ˆê¸°ê°’ ë¹„íŠ¸ì½”ì¸)
        let currentSymbol = "BTC";

        // 1. ì°¨íŠ¸ ë¡œë“œ í•¨ìˆ˜ (í´ë¦­ ì‹œ ìƒˆë¡œ ê·¸ë¦¬ê¸°)
        function loadChart(coinName) {
            currentSymbol = coinName;
            document.getElementById('tradingview_widget').innerHTML = ''; // ê¸°ì¡´ ì°¨íŠ¸ ì‚­ì œ
            new TradingView.widget({
                "autosize": true,
                "symbol": "UPBIT:" + coinName + "KRW",
                "interval": "5",
                "timezone": "Asia/Seoul",
                "theme": "dark",
                "style": "1",
                "locale": "ko",
                "toolbar_bg": "#131722",
                "enable_publishing": false,
                "hide_side_toolbar": false,
                "allow_symbol_change": true,
                "container_id": "tradingview_widget"
            });
            document.getElementById('current-coin-title').innerText = `[KRW-${coinName}] ë”¥ëŸ¬ë‹ 70+ ë³´ì¡°ì§€í‘œ ë¶„ì„`;
        }

        // 2. ì—”ì§„ ë°ì´í„° ë™ê¸°í™” í•¨ìˆ˜
        async function syncPhoenixData() {
            try {
                const res = await fetch('data.json?t=' + Date.now());
                const data = await res.json();
                
                // ìì‚° ë° ì—…ë°ì´íŠ¸ ì‹œê°„ ê°±ì‹ 
                document.getElementById('total-asset').innerText = Number(data.total_balance || 0).toLocaleString();
                document.getElementById('last-time').innerText = data.last_update.split(' ')[1]; // ì‹œê°„ë§Œ ì¶”ì¶œ

                // ì½”ì¸ ëª©ë¡ ë“±ë½ë¥  ìˆœìœ¼ë¡œ ì •ë ¬
                const sortedCoins = data.coins.sort((a, b) => b.rate - a.rate);
                
                // ì‚¬ì´ë“œë°” ë­í‚¹ ê·¸ë¦¬ê¸°
                const listContainer = document.getElementById('prob-list');
                listContainer.innerHTML = ''; // ì´ˆê¸°í™”
                
                sortedCoins.forEach(c => {
                    const isUp = c.rate > 0;
                    // í•œêµ­ ê±°ë˜ì†Œ í‘œì¤€: ìƒìŠ¹ì€ ë¹¨ê°•(rose), í•˜ë½ì€ íŒŒë‘(blue)
                    const color = isUp ? 'text-rose-500' : (c.rate < 0 ? 'text-blue-500' : 'text-slate-400');
                    const sign = isUp ? '+' : '';
                    const bgHover = currentSymbol === c.name ? 'bg-slate-800 border-orange-500/50' : 'hover:bg-slate-800/50 border-transparent';
                    
                    listContainer.innerHTML += `
                        <div class="flex justify-between items-center cursor-pointer p-2.5 rounded-lg transition border ${bgHover}" 
                             onclick="loadChart('${c.name}')">
                            <span class="text-slate-200 font-bold text-[11px]">${c.name} <span class="text-[9px] text-slate-500 font-normal">/ KRW</span></span>
                            <span class="${color} font-black text-[12px]">${sign}${c.rate.toFixed(2)}%</span>
                        </div>
                    `;
                });

                // ì‹œì¥ ìƒíƒœ AI íŒë…ê¸° (ê°„ë‹¨í•œ ë¡œì§)
                const topCoin = sortedCoins[0];
                const stateEl = document.getElementById('market-state');
                if(topCoin.rate >= 3) { stateEl.innerText = "ğŸ”¥ ê°•ë ¥ ë§¤ìˆ˜"; stateEl.className = "text-[11px] font-bold text-rose-500"; }
                else if(topCoin.rate <= -3) { stateEl.innerText = "â„ï¸ ê³µí¬ í•˜ë½"; stateEl.className = "text-[11px] font-bold text-blue-500"; }
                else { stateEl.innerText = "âš¡ ê´€ë§/ëŒ€ê¸°"; stateEl.className = "text-[11px] font-bold text-emerald-400"; }

            } catch (error) {
                console.log("ì—”ì§„ ë™ê¸°í™” ì§€ì—° ì¤‘...");
            }
        }

        // 3. ì´ˆê¸° ì‹¤í–‰ ë° 30ì´ˆ íƒ€ì´ë¨¸ ì„¸íŒ…
        loadChart(currentSymbol);
        syncPhoenixData();
        setInterval(syncPhoenixData, 30000);
    </script>
</body>
</html>
