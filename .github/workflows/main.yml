name: Phoenix Auto Engine

on:
  schedule:
    - cron: '*/5 * * * *' # 5ë¶„ë§ˆë‹¤ ìë™ ì‹¤í–‰
  workflow_dispatch: # ìˆ˜ë™ ì‹œë™ ë²„íŠ¼ í™œì„±í™”

jobs:
  run-engine:
    runs-on: ubuntu-latest
    steps:
    - name: ì €ì¥ì†Œ ê°€ì ¸ì˜¤ê¸°
      uses: actions/checkout@v3

    - name: íŒŒì´ì¬ í™˜ê²½ ì„¤ì •
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'

    - name: í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
      run: |
        pip install pyupbit requests

    - name: í”¼ë‹‰ìŠ¤ ì—”ì§„ ê°€ë™ (main.py ì‹¤í–‰)
      env:
        UPBIT_ACCESS: ${{ secrets.UPBIT_ACCESS }}
        UPBIT_SECRET: ${{ secrets.UPBIT_SECRET }}
        TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
        TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
      run: python Project_Phoenix_V2/master_engine/main.py

    - name: ê²°ê³¼ë¬¼(data.json) ì €ì¥ ë° ë°°í¬
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        git add data.json
        git commit -m "ğŸ”¥ í”¼ë‹‰ìŠ¤ ì—”ì§„: ì „í™© ë°ì´í„° ê°±ì‹ " || echo "No changes to commit"
        git push
